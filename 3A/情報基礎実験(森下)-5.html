<!DOCTYPE html>
<html lang="ja">
    <head>
        <link rel="shortcut icon" href="https://iwasakishuto.github.io/images/apple-touch-icon/University.png" />

        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Shuto" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="3A, 情報基礎実験(森下), 情報基礎実験(森下), " />
<meta property="og:image" content="https://iwasakishuto.github.io/images/FacebookImage/University.png"/>

<meta property="og:title" content="5.de Bruijn graphとその表現 "/>
<meta property="og:url" content="https://iwasakishuto.github.io/University/3A/情報基礎実験(森下)-5.html" />
<meta property="og:description" content="定義：ゲノムアセンブリ※ インデックスは0-originである。 記号・用語 定義 $$\Sigma=\{A,C,G,T\}$$ 塩基の集合 $$\Sigma^{\ast}$$ 全ての配列 $$^-:\Sigma^\ast\rightarrow\Sigma^\ast$$ 配列の相補塩基対（通常のワトソンクリックの相補対）を取るという演算 $$\mathbf{G}$$ ゲノム。塩基上の文字列 $$G=|\mathbf{G}|$$ ゲノムの文字列長 $$r$$ リード。ゲノム $\mathbf{G}$ からサンプリングされた、長さ $l \in \mathbb{N},l より正確には、$[0\cdots G-1]$ 上の一様分布に従う確率変数 $X$ の関数 $\mathbf{G}[X\cdots X+l)$ なお、スライスがインデックスの範囲を超えた場合は、環状ゲノムのことを示していると考える。$$\mathbf{G}[X\cdots X+l] = \mathbf{G}[X\cdots G] + \mathbf{G}[0\cdots X-G+l] $$ $$R$$ 独立にサンプリングした $N\in\mathbb{N}$ 本のリードの集合 $\{r_1,r_2,\cdots,r_N\}$ 各リードの長さは固定長 $l$ とする。 $$c=lN/G$$ 平均深度（データサイズ/ゲノムサイズ）。$\times10.4$ などと記されている。ここで、$\mathbf{G}$ がわかっていないにも関わらず $G$ がわかるのは、染色体の大きさから推定することができるからである。 深度 何回読まれたか 被覆度 どのくらいの割合が、最低1回読まれるか。 強連結成分 $V^{\prime}$ 頂点の部分集合で（$V^{\prime}\subset V(G)$）、「$V^{\prime}$ の頂点の中では互いに行き来できる」が、「$V^{\prime}$ から外には行き来できない（行くだけ、来るだけは可能でも良い。）」もの。 Lemma 1 (Coverage) ゲノム中の任意の場所 $G[i]$ での深度 $C_i$ は、$l\ll G$ かつ $G$ が十分に大きい時、パラメータ $\lambda=-c$ のポアソン分布に従う。" />
<meta property="og:site_name" content="3A" />
<meta property="og:article:author" content="Shuto" />
<meta property="og:article:published_time" content="2019-12-17T13:00:00+09:00" />
<meta property="og:article:modified_time" content="2019-12-17T13:00:00+09:00" />
<meta name="twitter:title" content="5.de Bruijn graphとその表現 ">
<meta name="twitter:description" content="定義：ゲノムアセンブリ※ インデックスは0-originである。 記号・用語 定義 $$\Sigma=\{A,C,G,T\}$$ 塩基の集合 $$\Sigma^{\ast}$$ 全ての配列 $$^-:\Sigma^\ast\rightarrow\Sigma^\ast$$ 配列の相補塩基対（通常のワトソンクリックの相補対）を取るという演算 $$\mathbf{G}$$ ゲノム。塩基上の文字列 $$G=|\mathbf{G}|$$ ゲノムの文字列長 $$r$$ リード。ゲノム $\mathbf{G}$ からサンプリングされた、長さ $l \in \mathbb{N},l より正確には、$[0\cdots G-1]$ 上の一様分布に従う確率変数 $X$ の関数 $\mathbf{G}[X\cdots X+l)$ なお、スライスがインデックスの範囲を超えた場合は、環状ゲノムのことを示していると考える。$$\mathbf{G}[X\cdots X+l] = \mathbf{G}[X\cdots G] + \mathbf{G}[0\cdots X-G+l] $$ $$R$$ 独立にサンプリングした $N\in\mathbb{N}$ 本のリードの集合 $\{r_1,r_2,\cdots,r_N\}$ 各リードの長さは固定長 $l$ とする。 $$c=lN/G$$ 平均深度（データサイズ/ゲノムサイズ）。$\times10.4$ などと記されている。ここで、$\mathbf{G}$ がわかっていないにも関わらず $G$ がわかるのは、染色体の大きさから推定することができるからである。 深度 何回読まれたか 被覆度 どのくらいの割合が、最低1回読まれるか。 強連結成分 $V^{\prime}$ 頂点の部分集合で（$V^{\prime}\subset V(G)$）、「$V^{\prime}$ の頂点の中では互いに行き来できる」が、「$V^{\prime}$ から外には行き来できない（行くだけ、来るだけは可能でも良い。）」もの。 Lemma 1 (Coverage) ゲノム中の任意の場所 $G[i]$ での深度 $C_i$ は、$l\ll G$ かつ $G$ が十分に大きい時、パラメータ $\lambda=-c$ のポアソン分布に従う。">

        <title>5.de Bruijn graphとその表現  · 3A
</title>
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/css/bootstrap-combined.v2.3.2.min.css">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/University/3A/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/University/3A/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/University/3A/theme/css/elegant.css">
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/University/3A/theme/css/admonition.css" media="screen">
        <!---->
        <link rel="apple-touch-icon" sizes="152x152" href="https://iwasakishuto.github.io/images/apple-touch-icon/University.png" type="image/png" />
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-164333757-1', 'auto');
    ga('send', 'pageview');
</script>



        <!-- Use fontawesome Icon -->
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
        <!-- Syntax highlight -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/github.min.css">
        <!-- Custom CSS -->
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/css/custom.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <!-- LaTex -->
        <!-- Github env -->
        <!--<script type="text/javascript" async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML"></script>
        <script type="text/x-mathjax-config">
        	MathJax.Hub.Config({
        		tex2jax: {
        			inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        			displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
        		}
        	});
        </script>
        <!-- Mermaid -->
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js" charset="UTF-8"></script>
        <script>
          mermaid.initialize({
            startOnLoad:true
          });
        </script>
        <script src="https://iwasakishuto.github.io/js/smooth-scroll.polyfills.min.js"></script>
    </head>
    <body>
        
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="https://iwasakishuto.github.io/University/3A"><span class=site-name style="color: #80273F;"><i class="fa fa-book"></i> 3A</span></a>
                    <!--
                    <a class="brand" href="https://iwasakishuto.github.io/University/3A/"><span class=site-name style="margin-left:auto; margin-right:auto;"><i class="fas fa-book-reader"></i>3A</span></a>
                    -->
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="https://iwasakishuto.github.io/"><i class="fas fa-home"></i>Portfolio Top</a></li>
                            <li ><a href="https://iwasakishuto.github.io/University/3A/categories"><i class="fa fa-list-alt"></i> Categories</a></li>
                            <li ><a href="https://iwasakishuto.github.io/University/3A/tags"><i class="fa fa-tags"></i> Tags</a></li>
                            <li ><a href="https://iwasakishuto.github.io/University/3A/archives"><i class="fa fa-folder-open"></i> Archives</a></li>
                            <li><form class="navbar-search" action="https://iwasakishuto.github.io/University/3A/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="https://iwasakishuto.github.io/University/3A/情報基礎実験(森下)-5.html"> 5.de Bruijn graphとその表現  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>定義：ゲノムアセンブリ</h3><p><b>※ インデックスは0-originである。</b></p>
<table>
<thead><tr>
<th style="text-align:center">記号・用語</th>
<th style="text-align:left">定義</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$$\Sigma=\{A,C,G,T\}$$</td>
<td style="text-align:left">塩基の集合</td>
</tr>
<tr>
<td style="text-align:center">$$\Sigma^{\ast}$$</td>
<td style="text-align:left">全ての配列</td>
</tr>
<tr>
<td style="text-align:center">$$^-:\Sigma^\ast\rightarrow\Sigma^\ast$$</td>
<td style="text-align:left">配列の相補塩基対（通常のワトソンクリックの相補対）を取るという演算</td>
</tr>
<tr>
<td style="text-align:center">$$\mathbf{G}$$</td>
<td style="text-align:left">ゲノム。塩基上の文字列</td>
</tr>
<tr>
<td style="text-align:center">$$G=|\mathbf{G}|$$</td>
<td style="text-align:left">ゲノムの文字列長</td>
</tr>
<tr>
<td style="text-align:center">$$r$$</td>
<td style="text-align:left">リード。ゲノム $\mathbf{G}$ からサンプリングされた、<strong>長さ $l \in \mathbb{N},l < G$ の配列。</strong>より正確には、$[0\cdots G-1]$ 上の一様分布に従う確率変数 $X$ の関数 $\mathbf{G}[X\cdots X+l)$ なお、スライスがインデックスの範囲を超えた場合は、環状ゲノムのことを示していると考える。$$\mathbf{G}[X\cdots X+l] = \mathbf{G}[X\cdots G] + \mathbf{G}[0\cdots X-G+l] $$</td>
</tr>
<tr>
<td style="text-align:center">$$R$$</td>
<td style="text-align:left">独立にサンプリングした $N\in\mathbb{N}$ 本のリードの集合 $\{r_1,r_2,\cdots,r_N\}$ 各リードの長さは固定長 $l$ とする。</td>
</tr>
<tr>
<td style="text-align:center">$$c=lN/G$$</td>
<td style="text-align:left">平均深度<strong>（データサイズ/ゲノムサイズ）</strong>。$\times10.4$ などと記されている。ここで、$\mathbf{G}$ がわかっていないにも関わらず $G$ がわかるのは、染色体の大きさから推定することができるからである。</td>
</tr>
<tr>
<td style="text-align:center">深度</td>
<td style="text-align:left">何回読まれたか</td>
</tr>
<tr>
<td style="text-align:center">被覆度</td>
<td style="text-align:left">どのくらいの割合が、最低1回読まれるか。</td>
</tr>
<tr>
<td style="text-align:center">強連結成分 $V^{\prime}$</td>
<td style="text-align:left">頂点の部分集合で（$V^{\prime}\subset V(G)$）、「$V^{\prime}$ の頂点の中では互いに行き来できる」が、「$V^{\prime}$ から外には行き来できない（行くだけ、来るだけは可能でも良い。）」もの。</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><h4 class="post_it_r" id="lemma1">Lemma 1 (Coverage)</h4></p>
<div class="post_it_wrapper">

　ゲノム中の任意の場所 $G[i]$ での深度 $C_i$ は、$l\ll G$ かつ $G$ が十分に大きい時、パラメータ $\lambda=-c$ のポアソン分布に従う。

</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><h4 class="post_it_b">Proof</h4></p>
<div class="post_it_wrapper">

　$i < G-l$ の時を考える。**ある位置 $i$ を覆うリードは、$i-l+1,\cdots,i$ の部分から開始されたリード**なので、一様分布からサンプリングしていることと合わせると、位置 $i$ での深度 $C_i$ は、

$$
\begin{aligned}
\operatorname{Pr}\left\{C_{i}=k\right\}
&=\left(\begin{array}{l}{N} \\ {k}\end{array}\right)\left(\frac{l}{G}\right)^{k}\left(1-\frac{l}{G}\right)^{N-k}\\
\end{aligned}
$$

　なる確率分布に従う。よって、仮定から**$\lambda=lN/G$ を固定して $G\rightarrow\infty$ の極限を取る**ことで、与式を得る。

</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><h4 class="post_it_r">Lemma 2</h4></p>
<div class="post_it_wrapper">

　リード長 $l$、ゲノムサイズ $G$、リード数 $N$ のシークエンシングをした際、$c=lN/G$ が一定で $G\rightarrow\infty$ とした時、ある位置が少なくとも $1$ つのリードで覆われる確率は $1-e^{-c}$ である。

</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><h4 class="post_it_b">Proof</h4></p>
<div class="post_it_wrapper">

　<a href="#lemma1">Lemma1</a>より、$\operatorname{Pr}\left\{C_{i}=k\right\}=\frac{e^k}{k!}\exp(-c)$ であるから、求める確率は、

$$1-\operatorname{Pr}\left\{C_{i}=0\right\} = 1-e^{-c}$$

</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>　以上より、<span class="marker-pink">「十分多くのリードを読めば、全ての箇所が読まれる確率が1に近づく」</span>ことがわかる。</p>
<p>　またここで、ゲノム $\mathbf{G}$ がわかっていて、2つのリード $r_i,r_j$ が $l\ast\theta\ (0<\theta\leq1)$ だけ重なっていれば、その2つは<span class="marker-pink">「重なった部分から取ってこられた」</span>と検知できるとする。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><h4 class="post_it_r">Lemma 3</h4></p>
<div class="post_it_wrapper">

　ある場所からリードが始まり、それから $l(1-\theta)$ 回、新しくリードが始まらない確率を考えれば、連続して取ってこられる領域の長さの期待値が

$$l\ast\left[\frac{e^{c(1-\theta)}-1}{c} + \theta\right]$$

となる。

</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><h4 class="post_it_b">Proof</h4></p>
<div class="post_it_wrapper">

　$l\left(1-\theta\right)$ 回、新しくリードが<b>「始まらない」</b>確率は、$1-\theta=s$ とおけば、

$$
\begin{aligned}
\left(1 - \frac{N}{G}\right) ^ { l\left(1-\theta\right)} &= \left(\underbrace{\left(1 - \frac{N}{G}\right)^\left(-\frac{G}{N}\right)}_{\underset{G\rightarrow\infty}{\Longrightarrow} e}\right)^{\left(-\frac{N}{G}\right)\cdot l\left(1-\theta\right)}\\
&= \exp\left(-cs\right)\\
\end{aligned}
$$

とかける。したがって、<b>ある連続して取ってこられる領域にあるリードの個数 $J$ </b>は、<b>失敗（新しく始まらない）</b>確率 $\exp\left(-cs\right)$ でコイン投げをして、最初に失敗するまでの回数と考えることができる。（<span class="marker-pink">幾何分布(geometric distribution)</span>）

　さらに、ここで各リード $i=1,\ldots,J$ が<b>次のリードに当たるまでの長さ</b>を $X_i$ とすると、これは<b>失敗確率 $1-N/G$ の幾何分布</b>に従う。よって、求める値は

$$\mathbb{E}\left[ X_1 + X_2 + \cdots + X_{J-1} + l\right]$$

となる。最後のリード開始点から固定長 $l$ の長さ分は確実に取ってこれるので、上式の形となる。また、$J$ 個のリードは<b>連続して取ってこられる領域内にある</b>ため、<span class="marker-pink"> $0\leq X_i \leq ls$ </span>となることがわかる。<b>（これより大きいと、$X_{i-1}$ と $X_i$ が重なったと判断できない。）</b>


　ここで、<a href="https://en.wikipedia.org/wiki/Wald%27s_equation">Wald's equation</a>を用いると、

$$\begin{aligned}
&\mathbb{E}\left[ X_1 + X_2 + \cdots + X_{J-1} + l\right]\\
=& \mathbb{E}\left[ X_1 + X_2 + \cdots + X_{J-1} + \left(X_J - X_J\right) + l\right]\\
=& \mathbb{E}\left[J\right]\mathbb{E}\left[X_1\right] - \mathbb{E}\left[X_J\right] + l\\
\end{aligned}
$$

と整理できる。また、

$$
\begin{cases}
  \mathbb{E}\left[X_i\right] &= l\left[ \frac{1-\exp\left(-cs\right)}{c} - s\exp\left(-cs\right)\right]\\
  \mathbb{E}\left[J\right] &= \exp\left(cs\right)
\end{cases}
$$

を用いてこれを解くと、

$$
\begin{aligned}
&\mathbb{E}\left[J\right]\mathbb{E}\left[X_1\right] - \mathbb{E}\left[X_J\right] + l\\
=& \exp\left(cs\right) \cdot l\left[ \frac{1-\exp\left(-cs\right)}{c} - s\exp\left(-cs\right)\right] - l\left[ \frac{1-\exp\left(-cs\right)}{c} - s\exp\left(-cs\right)\right] + l \\
=& l \left[ \frac{\exp(cs) - 1}{c} + 1 - s + \underbrace{s\exp(-cs)}_{\underset{c\rightarrow\infty}{\longrightarrow} 0} - \underbrace{\frac{1-\exp(-cs)}{c}}_{\underset{c\rightarrow\infty}{\longrightarrow} 0} \right]\\
\Longrightarrow & l \left[ \frac{\exp(cs) - 1}{c} + 1 - s \right]\\
=& l\left[\frac{e^{c(1-\theta)}-1}{c} + \theta\right]
\end{aligned}
$$


</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>なお、これはアセンブリが完全に実現できた場合の解析であり、<strong>ある種のアセンブリの上界を与えている</strong>と捉えることができる。</p>
<blockquote><p>ところで、ここにおける確証のためのパラメータ $\theta$ はどのくらいだろうか？これはゲノムの構成に依存する。例えば、ゲノムの中に、長い $A$ の連続が2箇所以上あった場合、ポリAのリードに対しては、$\theta=1$ でも、私達が思っている意味での確証はできないように思われる。敷衍して言えば、<strong>このパラメータ $\theta$ は、ゲノム配列とゲノム上の位置に依存するパラメータであって、どちらもアセンブリの前には手に入らないものだ。</strong></p>
</blockquote>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>　さて、では<strong>「これらのリード $R$ から、元のゲノム $\mathbf{G}$ を復元する方法」</strong>について考える。ここでは、以下の2つを挙げる。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><a href="#OLC">OLC</a></li>
<li><a href="#de-Bruijn-Graph">de Bruijn Graph</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="OLC">OLC<a class="anchor-link" href="#OLC">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>　最も愚直な手法は、以下の<span class="marker-pink">OLC</span>である。</p>
<ol>
<li><strong>(Overlap)</strong> 各リード $r_i$ と $r_j$ が、ゲノム上で連続した領域にあるかを判断する。</li>
<li><strong>(Layout)</strong> これらの情報を元に、リード $r_i$ を並べる。</li>
<li><strong>(Consensus)</strong> 並んだリードにたいして、各位置で、何らかの手法（例えば多数決）で塩基を確定させる。</li>
</ol>
<p>OLCは、ゲノムアセンブリ初期に行われ、現在でも、ロングリードシークエンサーの発達とともに再び日の目を見ている。しかし、</p>
<ul>
<li><strong>Overlapは計算が重い</strong>：
「全リードvs.全リード」の計算を行う必要があり、Suffix Array等で前計算を行い（$O(n\ast l)$）、<span class="marker-pink">SIMD(Single Instruction Multiple Data)</span>等で並列にDPを行うことで $O(n\ast l)$ で<strong>"近似的に"</strong>実行することができるが、それでも重い。</li>
<li><strong>Overlapが真であるかを確かめることが難しい：</strong>
「$r_i,r_j$ がアラインメントをすると良いスコアでアラインできる」からといって「$r_i,r_j$ がゲノム上で重複する部分から読まれている」とは言えない。</li>
<li><strong>Layoutは、厳密解を求めるのが難しい：</strong>
<strong>「各リードをノードとして、overlapしている組をエッジで結んだグラフ」</strong>において、<strong>「全てのノードを一回だけ使って、全てのノードを回るパスを発見すること」</strong>であるが、この問題はNP完全に属するハミルトン路問題と同一である。</li>
</ul>
<p>といった問題から、<strong>OLCのパラダイムに基づいて、ゲノムアセンブリを実行する際には、発見的方法、制約条件や作業仮説をつけることが必須になる。</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="de-Bruijn-Graph">de Bruijn Graph<a class="anchor-link" href="#de-Bruijn-Graph">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><b>定義：de Bruijn Graph</b></p>
<p>正の整数 $k$ に対して、$k$-de Bruijn Graphとは、次のような有向グラフ $G=(V,E)$ のことである。（文字に対しては半開区間でスライスを作ることに注意）</p>
<ol>
<li>$V\subset\Sigma^k$</li>
<li>$(u,v)\in E\Longleftrightarrow u[1,\ldots,k) = v[0,\ldots,k-1)$</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>　簡単に言えば、$k$-mer の集合を、<span class="marker-pink">『後ろ $k-1$ 文字と先頭 $k-1$ 文字が一致したら辺を引く』</span>というルールに基づいて辺を引けるだけ引いたグラフである。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>　ここで、リードの集合 $R$ から作られるde Bruijn Graphを、$R$ 中に出現する $k$-merをノードとするde Bruijn Graphだとする。つまり、<strong>$k+1$ より長いリードに関しては、短い断片にバラバラにしてしまう。</strong>（この時 $R$ 中に何回その $k$-merが現れたかを数えてノードに計数としてのせておく。）</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>　それでは、このde Bruijn Graphを用いてアセンブリを行う手法について考えるが、これは<strong>「ある $k$ を固定して、与えられたリードから、全ての $k$-merを抽出してde Bruijn Graphを作り、<span aria-label="与えられた有向グラフGがただ一つの強連結成分を持ち、Gの各頂点vについて、OUT(v)=IN(v)が成立する。" class="marker-info">オイラー閉路</span><b>（環状ゲノム）</b>/<span aria-label="全ての頂点へsから到達可能であり、IN(t)-OUT(t)=1,OUT(s)-IN(s)=1,OUT(v)=IN(v) for v≠s,t" class="marker-info">オイラーパス</span><b>（線状ゲノム）</b>を構築する」</strong>ことに他ならない。また、このアルゴリズムは<span aria-label="強連結成分がただ一つであるかをチェックするアルゴリズムとして有名なものには、「深さ優先探索を一回行い、その後辺の向きを全て逆にして、先程の深さ優先探索で最後にたどり着いた頂点から、もう一度深さ優先探索を行う」というものがある。" class="marker-info">明らかに $O(|E|)$ で計算できる。</span></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>　一般に、グラフ $G=(V,E)$ のオイラー閉路/パスを探すアルゴリズムを実装する際は、次のようにパス $P$、開始頂点 $v$ を持っておいて、深さ優先探索を一度だけ、グラフ $G$ を破壊しながら、再帰呼び出して行う擬似コードが用いられることが多い。</p>
<pre><code>1. For each nodes in {u | (v,u) ∈ E}
2. (a) Remove (v,u) from E
   (b) Call DFS(G,u)
3. Push v to P</code></pre>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>　このプログラムは、<strong>スタック数の上限にさえ気をつければ、辺の数に関して線形時間で解ける。</strong>本来は難しいはずの問題が、辺の数に関して線形時間で解けるのは、どこかでおかしいことが起きているということだと思われる。</p>
<ul>
<li>「ここまでの定式化のどこがおかしかったのだろうか？」</li>
<li>「現実世界で目にするインスタンスの中で、先程のオイラー閉路/オイラーパスとして解けないものには、どのようなものがあるだろうか？」</li>
</ul>
<p>詳しく見ていく。</p>
<ul>
<li><a href="#相補鎖">相補鎖</a></li>
<li><a href="#リピート（反復配列）">リピート（反復配列）</a></li>
<li><a href="#シークエンシングエラー">シークエンシングエラー</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="相補鎖">相補鎖<a class="anchor-link" href="#相補鎖">¶</a></h4><p>　シークエンシングを行う際に、<strong>「相補鎖・鋳型鎖」</strong>のどちらかを選択することは困難であり、またあるリードの対に対して、それらが同じ鎖から出てきたのか、それとも相補鎖から出てきたのかを知ることもできない。このとき、</p>
<ul>
<li>2つの鎖が共通の $k$-merを持っていない：2つの弱連結成分からなり、オイラー閉路/パスが2つ獲得できる。</li>
<li>2つの鎖が共通の $k$-merを持っている：グラフを巡回する間に別の鎖に乗り移ってしまうことがあり、これに対処するために以下の面倒な実装が必要となる。<ul>
<li>各ノードに $k$-merとその相補鎖を対応させる。</li>
<li>ノード間のエッジが必ず両方向に伸びる。</li>
<li>自分自身への多重ループができうる。</li>
<li>エッジに「鋳型鎖-相補鎖」というようなラベル付けをする。</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="リピート（反復配列）">リピート（反復配列）<a class="anchor-link" href="#リピート（反復配列）">¶</a></h4><ul>
<li>2つの異なったゲノム上の位置を占める配列が、全く同じ $k$-merを持ってしまう場合（$\ldots ARB\ldots CRD\ldots$）：<ul>
<li>ここから構築されるde Bruijn Graohから、グラフが「$\ldots ARB\ldots CRD\ldots$」から読んだリードから構成されたものなのか、「$\ldots ARD\ldots CRB\ldots$」から構成されたものなのかを判別することができない。</li>
<li>このようなグラフから、オイラー閉路/オイラーパスを構築できるかも定かではない。（パスが合流するところ（$R[0]$）では<strong>「出次数<入次数」</strong>となるが、分流する場所ではその逆となる。）</li>
<li>paired endというシークエンシング法を使えば、元のリードの情報から、オイラー閉路を選んだり・ノードを複製したり・エッジを複製したりしてアセンブリ結果を良くすることができる。</li>
</ul>
</li>
<li>タンデムリピートの場合（$\ldots RRRR\ldots RRRRR\ldots$）<ul>
<li>ループ構造になり、$R$ の繰り返し回数を推定することが極めて難しい。</li>
</ul>
</li>
</ul>
<p><strong>※ これらの難しい問題に対処するために、現代的なアセンブラでは、リピートに関しては、解決できない部分は諦めて、確信が持てる– 必ず正しいような– 配列のみを出力するようになっている。</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="シークエンシングエラー">シークエンシングエラー<a class="anchor-link" href="#シークエンシングエラー">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>de Bruijn Graphは、<strong>「全てのリードが完全に正しいこと」</strong>を要求しており、一塩基の誤りが、$k$ 個の誤った頂点と、$k − 1$ 個の誤った辺を誘導する。</li>
<li>（辺の重みを持たない）de Bruijn Graph そのものには、<strong>このようなエラーを訂正する機能がない</strong>ため、オイラー閉路/パスを辿る過程でも、エラーかどうか判定できない。</li>
<li>被覆度を上げるためには十分な量のリードを読む<span class="marker-pink">（スループットを上げる）</span>必要があるが、これに伴って、エラーの総数が、リードの個数に線形に増えていってしまう。</li>
<li>対処法としては、以下が挙げられる。<ul>
<li>Fastqファイルの信頼度を利用し、<ul>
<li>何らかの閾値を用いて塩基の精度が低いものを取り除く。</li>
<li>ほとんど現れない $k$-merに関しては、単に無視する。</li>
</ul>
</li>
<li>de Bruijn Graphの実装において、<ul>
<li>ある頂点の近くだけで探索することによって、エラーを検知して、他の辺にマージする。</li>
<li>深さ優先探索をしていく中で、極端にすぐに行き止まる（本当は無い道を進んでしまった）場合は、直前の分岐までをなかったことにする。</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="実装における工夫：BloomFilter">実装における工夫：BloomFilter<a class="anchor-link" href="#実装における工夫：BloomFilter">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>　$k = 50$ 程度でde novo アセンブリを行うと、あり得る $k$-mer の数も多くなり、シークエンス深度によっては、数百ギガバイトものメモリを要求することもある。現在では、多数の実装が開発されており、その最適化の方法、実際の問題に対する性能もまちまちだが、今回は<span class="marker-pink">Bloom Filter を用いた確率的 de Bruijn Graph</span>について記述する。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>BloomFilterとは、1970 年にBloomらによって開発された、確率的データ構造である。このデータ構造は、ハッシュが計算できるような要素の集合に対する表現を与えるもので、空間効率が非常に高くなるほか、集合に対する所属、追加、そして集合同士の和を高速に計算できることが特徴である。</p>
</blockquote>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div style="padding: 0.25em 0.5em; border-left: solid 5px black; background-color: rgb(255,243,184,0.5)"><b>定義：Bloom Filter</b>

$M$ を正の整数、$U$ を任意の集合として、$U$ に対して、$p$ 個のハッシュ函数 $h_i:U\rightarrow\{1\cdots M\}$ があるとする。このとき、集合 $U$、ハッシュ関数 $\{h_i\}$ から構成されるBloomFilter $B$ とは、$M$ 長のBit列 $B\in\{t,f\}^M$ のことである。

</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="演算">演算<a class="anchor-link" href="#演算">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>BloomFilter $B,B^{\prime}$、要素 $e\in U$ に対して、次のように演算を定義する。</p>
<table>
<thead><tr>
<th style="text-align:center">#</th>
<th style="text-align:left">演算</th>
<th style="text-align:left">Return</th>
<th style="text-align:left">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left"><code>add:(BloomFilter:B, U:e)</code> → BloomFilter</td>
<td style="text-align:left">$$B^{\prime} \text { such that } B^{\prime}[i]=B[i] \wedge h_{1}(e) \wedge h_{2}(e) \cdots \wedge h_{p}(e) \text { for all } i \in\{1, \cdots, M\}$$</td>
<td style="text-align:left">各ハッシュ値を計算して、その番地に<code>true</code>を立てる。</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left"><code>has:(BloomFilter:B, U:e)</code> → {t,f}</td>
<td style="text-align:left">$$B\left[h_{1}(e)\right] \wedge B\left[h_{2}(e)\right] \cdots \wedge B\left[h_{p}(e)\right]$$</td>
<td style="text-align:left">各ハッシュ値を計算して、それらの番地の場所に全て<code>true</code>が立っているか返す。</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left"><code>union:(BloomFilter:B, BloomFilter:B′)</code> → BloomFilter</td>
<td style="text-align:left">$$B\mid B^{\prime}$$</td>
<td style="text-align:left">2つのBloomFilterのBitORを取って返す。</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>1つの要素 $e\in U$ に対して、$p$ 個のハッシュ値を計算し、それらが<strong>「全て<code>true</code>であれば含まれている」</strong>/<strong>「どれか一つでも<code>false</code>であれば含まれていない」</strong>とする。</li>
<li>一度BloomFilter $B$ に要素 $e$ を挿入(<code>B.add(e)</code>すれば、以降、<strong>この要素が存在するかどうかのクエリ(<code>B.has(e)</code> は、必ず正しい答え(<code>true</code>) を返す。</strong><code>union</code>がBitORを取っていることから、<strong>この条件は<code>union</code>後も満たされる。</strong></li>
<li>挿入していないある要素 $e^{\prime}$ については、<code>B.has(e′)</code>は<strong>ほとんどの場合<code>false</code>になる</strong>が、偶然、ハッシュ値 $h_1(e^{\prime})\cdots h_p(e^{\prime})$ がすでに全て埋められているときには、間違えて<code>true</code>を返してしまう。</li>
</ul>
<p>※ つまり、<span class="marker-pink">BloomFilterには偽陰性はないが、偽陽性はある。</span>直感的には、</p>
<ul>
<li>ハッシュ函数が少なすぎると、同じハッシュ函数値の集合を持った要素がたくさん出てきてしまう</li>
<li>ハッシュ函数が多すぎると、すぐにBitVectorがすべて<code>true</code>で埋まってしまう。</li>
<li>$N$ 個の要素を挿入した、$M$ 長のBitVectorと $p$ 個のハッシュ函数からなるBloomFilterの偽陽性は、簡単な計算から $\left(1-e^{-pN/M}\right)^p$ と近似できる。</li>
<li>この近似から、<span class="marker-pink">最適なハッシュ函数の個数が $p=\frac{N}{M}\ln2$ </span>の近くの整数になることがわかる。</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>このBloomFilterを用いた「ゆるい」de Bruijn Graohが<span class="marker-pink">probabilistic de Bruijn Graph</span>である。</p>
<ul>
<li>de Bruijn Graphにおいて、<strong>「2つのノードに対してエッジが引かれること」</strong>と<strong>「それらの $k-1$ 長の接頭辞と接尾辞が同じこと」</strong>は同値であるため、<span class="marker-pink">ノードを確定すれば、エッジは自動的に決まる。</span></li>
<li>ゆえに、de Bruijn Graph を表現するためには、ある $k$-mer に対して、<strong>「それが含まれるか否かを答えるメソッド」</strong>が定義できればよいことになる。</li>
<li>このとき問題となるのは、<span class="markre-pink">偽陽性</span>であり、そのうちの<strong>「偽陽性であるとしてしまった $k$-merが、本当の $k$-mer間にパスを構成する時」</strong>である。（<strong>小さな引き込み路しか作らないなら、リードに混入するエラーを取り除くアルゴリズムを流用すれば対処可能。</strong>）<ul>
<li>うその $k$-merの集合を予め全て列挙<strong>（Black List）</strong>しておけば間違いは無くなるが、これだと<strong>情報論理の観点から、一切の圧縮ができなくなる。</strong></li>
<li>そこで、<span class="marker-pink">偽陽性のうちの重大なもの（`B.has(e)`とクエリされる $e$ のみ）</span>を列挙しようと考える。</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><b>定義：Critical False Positive</b></p>
<table>
<thead><tr>
<th style="text-align:center">記号・用語</th>
<th style="text-align:left">定義</th>
<th style="text-align:left">definition</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$$\mathcal{S}$$</td>
<td style="text-align:left">リード中の $k$-merの集合</td>
<td style="text-align:left">true positive nodes</td>
</tr>
<tr>
<td style="text-align:center">$$\mathcal{E}$$</td>
<td style="text-align:left">$\mathcal{S}$ の要素と直接辺で結ばれている $k$-mer。言い換えれば、グラフを巡回する際に、クエリになる $k$-merの集合</td>
<td style="text-align:left">extensions of nodes from $\mathcal{S}$</td>
</tr>
<tr>
<td style="text-align:center">$$\mathcal{P}$$</td>
<td style="text-align:left">$e\in\mathcal{E}$ で BloomFilter $B$ が <code>B.has(e) = true</code> を返す $k$-merの集合</td>
<td style="text-align:left">all elements of $\mathcal{E}$ for which the Bloom filter answers <em>yes</em>.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>　ここで、我々が気をつけるべき偽陽性は、<span class="marker-pink">『$\mathcal{P}$ のうち、$\mathcal{S}$ には無いようなもの』</span>である。このことを<span class="marker-pink">Critical False Positive</span>と呼ぶ。$\left(cFP = \mathcal{P}\setminus\mathcal{S}\right)$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="q1" style="padding: 0.25em 0.5em; border-left: solid 5px red; background-color: rgba(255,192,203,0.5)">課題1: Bloom Filter(One of two)</h3><p>　次の三題から二題を選んで解け。</p>
<ol>
<li>集合 $U$ から $N$ 個の要素をランダムにサンプリングして、$M$ 長の BitVector を使った BloomFilter で表現する時、偽陽性が最も小さくなるようなハッシュ関数の個数を求めよ。ハッシュ関数は $U$ の要素を、$\{1,\cdots,M\}$ までの値に偏りなくマップすると考えてよい。</li>
<li>$M$ を $3$ 以上の素数とする。$A,B$ を、$\{1,\cdots,M\}$ 上の一様分布に独立に従うものとする。確率変数 $Y_i=A\ast i+B, i=1,\cdots,t$ について、<strong>『$i\neq j\Rightarrow\text{$Y_i$ and $Y_j$ are independent.}$』</strong>であることを示せ。
ただし、素数 $M$ の剰余類で、連立方程式 $y_i=a\ast i+b, y_j=a\ast j+b$ は、$a,b$ について必ず一意に解けることを用いてもよい。ここから、BloomFilter において、$p$ 個のハッシュ関数をどのように構築すればよいか示せ。ハッシュ函数についてより知りたい場合は <strong><a href="https://www.eecs.harvard.edu/~michaelm/postscripts/rsa2008.pdf">"Adam Kirsch and Michael Mitzenmacher.  Less hashing, same performance: Building abetter Bloom filter.Random Structures and Algorithms, 33(2):187–218, sep 2008."</a></strong> などを参考にせよ。</li>
<li>k-merの集合 $S$ に対して、CriticalFalseNegative を $O(\|S\|k)$ で構成するアルゴリズムを与えよ。ランダムアクセスメモリを仮定してよく、メモリ空間は必要な分だけ好きに確保できるとしてよい。</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="a1" style="padding: 0.25em 0.5em; border-left: solid 5px blue; background-color: rgba(130,192,255,0.5)">解答</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="1">1<a class="anchor-link" href="#1">¶</a></h4><p>Bit Vectorの $i$ 番目の位置に <code>true</code> を立てるハッシュ値の数を $B[i]$ で表す。ここで、$Np$ 個のハッシュ値が一様分布に従っていると仮定すると、</p>
$$
\begin{aligned}
\operatorname{Pr}\left\{B[i]=k\right\}
&=\left(\begin{array}{l}{pN} \\ {k}\end{array}\right)\left(\frac{1}{M}\right)^{k}\left(1-\frac{1}{M}\right)^{pN-k}\\
&=\frac{(pN)!}{k!(pN-k)!}\left(\frac{\lambda}{pN}\right)^k\left(1-\frac{\lambda}{pN}\right)^{-k}\left(1-\frac{\lambda}{pN}\right)^{pN}\quad\left(\because \lambda=pN/M\right)\\
&=\frac{\lambda^k}{k!}
{\underbrace{\left(1-\frac{\lambda}{pN}\right)}_{\underset{pN\rightarrow\infty}{\longrightarrow}e^{-\lambda}}}^{pN}
{\underbrace{\left(1-\frac{\lambda}{pN}\right)}_{{\underset{pN\rightarrow\infty}{\longrightarrow1}}}}^{-k}
\underbrace{\frac{(pN)!}{(pN-k)!(pN)^k}}_{\underset{pN\rightarrow\infty}{\longrightarrow1}}\\
&\underset{pN\rightarrow\infty}{\longrightarrow} e^{-\lambda}\frac{\lambda^k}{k!}
\end{aligned}
$$<p>　なる確率分布に従う。従って、偽陽性となる確率(False Positive Rate; FPR)は、以下で<strong>近似</strong>できる。</p>
$$
\begin{aligned}
\operatorname{FPR}(p) &= \left(1-\operatorname{Pr}\left\{B[i]=0\right\}\right)^p\\
&= \left(1-e^{-\lambda}\right)^p\\
&= \left(1 - e^{-pN/M}\right)^p
\end{aligned}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>　ここで、</p>
$$
\begin{aligned}
\frac{\partial\ln\left(\operatorname{FPR}(p)\right)}{\partial p} 
&= \frac{\partial}{\partial p}\left(p\ln\left(1 - e^{-pN/M}\right)\right)\\
&=\ln\left(1 - e^{-pN/M}\right) + \frac{pN}{M}\frac{e^{-pN/M}}{1 - e^{-pN/M}}\\
\therefore\left.\frac{\partial\ln\left(\operatorname{FPR}(p)\right)}{\partial p}\right|_{p = \frac{M}{N}\ln2}
&=\ln\left(1 - \frac{1}{2}\right) + \ln2\frac{1/2}{1 - 1/2}\\
&= -\ln2 + \ln2 \\
&= 0
\end{aligned}
$$<p>となるため、最適なハッシュ函数の個数は整数値であるから、<span class="unRed">$p = \frac{M}{N}\ln2$ 付近の整数</span></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="2">2<a class="anchor-link" href="#2">¶</a></h4><p>　素数 $M$ の剰余類で、連立方程式</p>
$$\begin{cases}
y_i&=a\ast i+b\\
y_j&=a\ast j+b
\end{cases}$$<p>は、$a,b$ について必ず一意に解けることを用いれば、$y_i$ が与えられた時、</p>
$$y_j = a\ast \left(j-i\right) + y_i$$<p>となり、これは $i\neq j$ の時、$y_i$ と独立になる。</p>
<p>　従って、</p>
$$h_i = A\ast i + B\quad\operatorname{mod} M$$<p>というハッシュ関数を $p$ 個用意すれば良いことになる。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="3">3<a class="anchor-link" href="#3">¶</a></h4><p>　<strong>Critical False Positive</strong> は、「<strong>『リード中のk-merの集合 $\mathcal{S}$ の要素と直接辺で結ばれている $k$-merで、BloomFilter $B$ が <code>B.has(e) = true</code> を返すもの』</strong> のうち、$\mathcal{S}$ に無いようなもの」を指す。</p>
<p>　したがって、以下のアルゴリズムで、$O(\|S\|k)$ によって<strong>Critical False Positive</strong> の構築が可能である。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="n">cFP</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">P</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">kmer</span> <span class="ow">in</span> <span class="n">S</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">kmer</span><span class="o">.</span><span class="n">extensions</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">B</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">e</span><span class="p">):</span> <span class="c1"># O(1)</span>
            <span class="c1"># P.append(e)</span>
            <span class="k">if</span> <span class="n">e</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">S</span><span class="p">:</span> <span class="c1"># O(k): Using Trie Tree </span>
                <span class="n">cFP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="q2" style="padding: 0.25em 0.5em; border-left: solid 5px red; background-color: rgba(255,192,203,0.5)">課題2: Information theory</h3><ul>
<li>$n$ 通りのものから一つを選び、それを表現するときは、<strong>$\log n$ bit</strong> が必要になる（$n$ 個を『辞書式順序』で並べて、何番目かを伝えれば良い）。</li>
<li>$n$ 通り値を取り得るものから、重複無しに $m$ 個選んだ集合を表す（i.e, $V\in U, |U|=n,|V|=m$ なる $V$ を表す）場合には、$\Omega\left(\log \left(\begin{array}{c}{n} \\ {m}\end{array}\right)\right)$ bit 必要になる。</li>
</ul>
<p>　ここで、$k$-de Bruijn Graph を表現するときは、頂点、すなわち $\Sigma^k$ の任意の部分集合を表現すれば良い。したがって、$k$-de Bruijn Graph を表現するには、$k$、ノードの個数 $n$ に続けて、どの $k$-<em>mer</em> を選んだかを伝えなければならず、最低でも以下のbitが必要になる（桁数を表すのに追加でbitが使われる）。</p>
$$
\Omega\left(\log k+\log n+\log \left(\begin{array}{l}{\Sigma^{k}} \\ {n}\end{array}\right)\right)
$$<p>次の問いに答えよ。</p>
<ol>
<li>一般に、$n$ 通りの値を取り得るものから、重複無しに $m$ 個選んだ集合を Bloom Filter で表現すると、上記で示した下界より小さくできる。これは下界を破っているように見えるが、そうではない理由を説明せよ（つまり、この BloomFilter は対象の集合を表せていないことを示せ）</li>
<li>$k$-de Bruijn graph を、二つの BloomFilter を使って表現することを考える。このデータ構造は複数の BloomFilter からなり、さらに、de Bruijn graph をたどるようなクエリに対しては偽陽性はない。しかも、必要なbit数は上記の下界よりも小さい。一見、この状態は下界を破っているように見えるが、実はそうではない理由を説明せよ。</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="a2" style="padding: 0.25em 0.5em; border-left: solid 5px blue; background-color: rgba(130,192,255,0.5)">解答</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">raise</span> <span class="ne">KeyboardInterrupt</span><span class="p">(</span>
    <span class="s2">"I didn't understand what the problem statement means."</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg"><ipython-input-1-531c57a748d8></span> in <span class="ansi-cyan-fg"><module></span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> raise KeyboardInterrupt(
<span class="ansi-green-fg">----> 2</span><span class="ansi-red-fg">     </span><span class="ansi-blue-fg">"I didn't understand what the problem statement means."</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> )

<span class="ansi-red-fg">KeyboardInterrupt</span>: I didn't understand what the problem statement means.</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><h3 id="q3" style="padding: 0.25em 0.5em; border-left: solid 5px red; background-color: rgba(255,192,203,0.5)">課題3: de Bruijn Graph(Optional)</h3>
<br /></p>
<div style="padding: 0.25em 0.5em; border-left: solid 5px black; background-color: rgb(255,243,184,0.5)"><b>Remark</b>
<p>　以下で用いるデータセットは、人為的に作成されており、次のような性質を満たす。</p>
<ol>
<li>カバレッジは十分量ある（被覆度は1になるように設計してある）</li>
<li>各リードは必ずゲノム中の位置からサンプリングされているし、エラーはない。</li>
<li>どちらか一方の鎖からしかリードはサンプリングされていない。つまり、相補鎖について考える必要はない。</li>
<li>あるkがあり、このkを用いて作った k-mer de Bruijn Graph は <b>"ほとんど"</b>リニアになっている。つまり、ほとんどのノードの入次数と出次数は1になる。</li>
</ol>
</div><p>　（確率的であれ、別のものであれ）de Bruijn Graph を実装し、<code>.fasta</code> fileと整数 $k$ を入力として、何らかの <code>.fasta</code> fileを出力するようなプログラムを書け（注：頑張りすぎないこと。ノードを選んで探索すればよい）。</p>
<p>　余裕がある人は、2つのデータセット tiny と large に対して、何か $k$ を決めて、リードから $k$-deBruijn Graph を構築して、その上で何かしらのパスを求めてみよ。</p>
<p>　参考のために、リードをサンプリングした配列もデータセットに含めておいた。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="a3" style="padding: 0.25em 0.5em; border-left: solid 5px blue; background-color: rgba(130,192,255,0.5)">解答</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">kerasy.utils</span> <span class="kn">import</span> <span class="n">read_fastseq</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">true_seq</span> <span class="o">=</span> <span class="n">read_fastseq</span><span class="p">(</span><span class="s2">"dataset/tiny/assumed_genome_size1K_readlength_100.fasta"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">reads</span> <span class="o">=</span> <span class="n">read_fastseq</span><span class="p">(</span><span class="s2">"dataset/tiny/tiny.fa"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">kerasy.search.debruijn</span> <span class="kn">import</span> <span class="n">kmer_deBruijnGraph</span>

<span class="n">k</span> <span class="o">=</span> <span class="mi">89</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">kmer_deBruijnGraph</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">reads</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"num sequences : </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">num_reads</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"average length: </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">ave_read_length</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>num sequences : 150
average length: 100.0
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">export_graphviz</span><span class="p">(</span><span class="sa">f</span><span class="s2">"deBruijnGraph_</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">mer.png"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">kerasy.Bio.alignment</span> <span class="kn">import</span> <span class="n">SmithWaterman</span>

<span class="n">score_model</span> <span class="o">=</span> <span class="n">SmithWaterman</span><span class="p">()</span>
<span class="n">score_model</span><span class="o">.</span><span class="n">load_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Loading Parameters from <span class="ansi-blue-fg">/Users/iwasakishuto/Github/portfolio/Kerasy/kerasy/utils/default_params/SmithWaterman.json</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"length of the true sequence: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">true_seq</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">true_seq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>length of the true sequence: 1000
GAAGACTGCACGTTGCATATTTGCCATCATCTATGGACCGTGCGAGAATTCAATACTAATCCTGTCCGCAGTTAGTTTAAATCCGACGGGCTCAGTTCGCTAGTAGAACCAACGCGCTCTCCAGGAATCTAACAATCAACTTCTTCATTGCCGGTAACCTTGTTCAATAACACTAACACCTTTCTAAGCCACCCGTAACAGTACTCCTTCCTGGGCTGTTCTACAACAAGGAGAGGTTTACGTTTGACCCGGTTTCCATTTATTTAACAGCGGCTTATTATTAGCCATCGACTCTGAGTTCACCTTTACGACTCTCTCATTAATCCCTAGGTAAACCTTGCATCCACGAACTAATTGCTATCTTATTGCACGCGTGAGTCAACGCGGGCCTAACCAGTAGGTCGGTGCAGTACTGAAGACAAGGCGATCAAGGCGTCCAAGAGCGCATGCCCCGACCGAAGGTACATCCCGTGCTGTAGACGGACAGATCTTGCCCATCGGGTTTCCATTTATTTAACAGCGGCTTATTATTAGCCATCGACTCTGAGTTCACCTTTACGACTCTCTCATTAATCCCTAGGTAAACCTTGCATCCACGAACTAATTGCTATCTTATTGCACGCGTACTTATCAAATTAAGTAGTCATCCGTCACACGAGACGGAAGCCTTGCCGGTGACCGTAACCTAGTTACTACGCAGAGGACACTTGTCACTCTCCTTCGAAACTCTACACCGGGGAAACTCGTCTCCATCCCCTTTGCATAGGTGTCTTCATTAAAAGTGTCATAGACTCAGACGTTCGCCTTCCTGAACCAACAGGATCAGCGGCTCCCGGCCACCACTTGGATTACCGCCAGAGGCCATCGCTGCGCGAGTTCTGGAAAAAGATTGAAACCAGCGTCTAACTTCTCTTACAGGCACAATCTCAGGTCGTTTATCCAGAATGACCACAAATCTCGGTAAAATCTTTCTCGGCCTCTTACTCGGTGTGGACGGCGC
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">init</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">inits</span><span class="p">:</span>
    <span class="n">result_trail</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">assemble</span><span class="p">(</span><span class="n">init</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">result_trail</span><span class="p">:</span>
        <span class="n">score_model</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">true_seq</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"*"</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">102.000</span>

=============================================================================
A: [0858] AGGCCATCGCTGCGCGAGTTCTGGAAAAAGATTGAAACCAGCGTCTAACTTCTCTTACAG [0918]
B: [0000] AGGCCATCGCTGCGCGAGTTCTGGAAAAAGATTGAAACCAGCGTCTAACTTCTCTTACAG [0060]

A: [0918] GCACAATCTCAGGTCGTTTATCCAGAATGACCACAAATCTCG [0959]
B: [0060] GCACAATCTCAGGTCGTTTATCCAGAATGACCACAAATCTCG [0101]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">107.000</span>

=============================================================================
A: [0785] CATAGACTCAGACGTTCGCCTTCCTGAACCAACAGGATCAGCGGCTCCCGGCCACCACTT [0845]
B: [0000] CATAGACTCAGACGTTCGCCTTCCTGAACCAACAGGATCAGCGGCTCCCGGCCACCACTT [0060]

A: [0845] GGATTACCGCCAGAGGCCATCGCTGCGCGAGTTCTGGAAAAAGATTG [0891]
B: [0060] GGATTACCGCCAGAGGCCATCGCTGCGCGAGTTCTGGAAAAAGATTG [0106]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">63.000</span>

=============================================================================
A: [0937] ATCCAGAATGACCACAAATCTCGGTAAAATCTTTCTCGGCCTCTTACTCGGTGTGGACGG [0997]
B: [0000] ATCCAGAATGACCACAAATCTCGGTAAAATCTTTCTCGGCCTCTTACTCGGTGTGGACGG [0060]

A: [0997] CGC [0999]
B: [0060] CGC [0062]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">115.000</span>

=============================================================================
A: [0580] GTAAACCTTGCATCCACGAACTAATTGCTATCTTATTGCACGCGTACTTATCAAATTAAG [0640]
B: [0000] GTAAACCTTGCATCCACGAACTAATTGCTATCTTATTGCACGCGTACTTATCAAATTAAG [0060]

A: [0640] TAGTCATCCGTCACACGAGACGGAAGCCTTGCCGGTGACCGTAACCTAGTTACTA [0694]
B: [0060] TAGTCATCCGTCACACGAGACGGAAGCCTTGCCGGTGACCGTAACCTAGTTACTA [0114]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">102.000</span>

=============================================================================
A: [0608] TATCTTATTGCACGCGTACTTATCAAATTAAGTAGTCATCCGTCACACGAGACGGAAGCC [0668]
B: [0000] TATCTTATTGCACGCGTACTTATCAAATTAAGTAGTCATCCGTCACACGAGACGGAAGCC [0060]

A: [0668] TTGCCGGTGACCGTAACCTAGTTACTACGCAGAGGACACTTG [0709]
B: [0060] TTGCCGGTGACCGTAACCTAGTTACTACGCAGAGGACACTTG [0101]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">108.000</span>

=============================================================================
A: [0818] AGGATCAGCGGCTCCCGGCCACCACTTGGATTACCGCCAGAGGCCATCGCTGCGCGAGTT [0878]
B: [0000] AGGATCAGCGGCTCCCGGCCACCACTTGGATTACCGCCAGAGGCCATCGCTGCGCGAGTT [0060]

A: [0878] CTGGAAAAAGATTGAAACCAGCGTCTAACTTCTCTTACAGGCACAATC [0925]
B: [0060] CTGGAAAAAGATTGAAACCAGCGTCTAACTTCTCTTACAGGCACAATC [0107]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">117.000</span>

=============================================================================
A: [0146] ATTGCCGGTAACCTTGTTCAATAACACTAACACCTTTCTAAGCCACCCGTAACAGTACTC [0206]
B: [0000] ATTGCCGGTAACCTTGTTCAATAACACTAACACCTTTCTAAGCCACCCGTAACAGTACTC [0060]

A: [0206] CTTCCTGGGCTGTTCTACAACAAGGAGAGGTTTACGTTTGACCCGGTTTCCATTTAT [0262]
B: [0060] CTTCCTGGGCTGTTCTACAACAAGGAGAGGTTTACGTTTGACCCGGTTTCCATTTAT [0116]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">112.000</span>

=============================================================================
A: [0873] GAGTTCTGGAAAAAGATTGAAACCAGCGTCTAACTTCTCTTACAGGCACAATCTCAGGTC [0933]
B: [0000] GAGTTCTGGAAAAAGATTGAAACCAGCGTCTAACTTCTCTTACAGGCACAATCTCAGGTC [0060]

A: [0933] GTTTATCCAGAATGACCACAAATCTCGGTAAAATCTTTCTCGGCCTCTTACT [0984]
B: [0060] GTTTATCCAGAATGACCACAAATCTCGGTAAAATCTTTCTCGGCCTCTTACT [0111]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">106.000</span>

=============================================================================
A: [0219] TCTACAACAAGGAGAGGTTTACGTTTGACCCGGTTTCCATTTATTTAACAGCGGCTTATT [0279]
B: [0000] TCTACAACAAGGAGAGGTTTACGTTTGACCCGGTTTCCATTTATTTAACAGCGGCTTATT [0060]

A: [0279] ATTAGCCATCGACTCTGAGTTCACCTTTACGACTCTCTCATTAATC [0324]
B: [0060] ATTAGCCATCGACTCTGAGTTCACCTTTACGACTCTCTCATTAATC [0105]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">172.000</span>

=============================================================================
A: [0628] TATCAAATTAAGTAGTCATCCGTCACACGAGACGGAAGCCTTGCCGGTGACCGTAACCTA [0688]
B: [0000] TATCAAATTAAGTAGTCATCCGTCACACGAGACGGAAGCCTTGCCGGTGACCGTAACCTA [0060]

A: [0688] GTTACTACGCAGAGGACACTTGTCACTCTCCTTCGAAACTCTACACCGGGGAAACTCGTC [0748]
B: [0060] GTTACTACGCAGAGGACACTTGTCACTCTCCTTCGAAACTCTACACCGGGGAAACTCGTC [0120]

A: [0748] TCCATCCCCTTTGCATAGGTGTCTTCATTAAAAGTGTCATAGACTCAGACGT [0799]
B: [0120] TCCATCCCCTTTGCATAGGTGTCTTCATTAAAAGTGTCATAGACTCAGACGT [0171]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">96.000</span>

=============================================================================
A: [0000] GAAGACTGCACGTTGCATATTTGCCATCATCTATGGACCGTGCGAGAATTCAATACTAAT [0060]
B: [0018] GAAGACTGCACGTTGCATATTTGCCATCATCTATGGACCGTGCGAGAATTCAATACTAAT [0078]

A: [0060] CCTGTCCGCAGTTAGTTTAAATCCGACGGGCTCAGT [0095]
B: [0078] CCTGTCCGCAGTTAGTTTAAATCCGACGGGCTCAGT [0113]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">101.000</span>

=============================================================================
A: [0359] ATCTTATTGCACGCGTGAGTCAACGCGGGCCTAACCAGTAGGTCGGTGCAGTACTGAAGA [0419]
B: [0000] ATCTTATTGCACGCGTGAGTCAACGCGGGCCTAACCAGTAGGTCGGTGCAGTACTGAAGA [0060]

A: [0419] CAAGGCGATCAAGGCGTCCAAGAGCGCATGCCCCGACCGAA [0459]
B: [0060] CAAGGCGATCAAGGCGTCCAAGAGCGCATGCCCCGACCGAA [0100]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">100.000</span>

=============================================================================
A: [0549] TCACCTTTACGACTCTCTCATTAATCCCTAGGTAAACCTTGCATCCACGAACTAATTGCT [0609]
B: [0000] TCACCTTTACGACTCTCTCATTAATCCCTAGGTAAACCTTGCATCCACGAACTAATTGCT [0060]

A: [0609] ATCTTATTGCACGCGTACTTATCAAATTAAGTAGTCATCC [0648]
B: [0060] ATCTTATTGCACGCGTACTTATCAAATTAAGTAGTCATCC [0099]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">69.000</span>

=============================================================================
A: [0000] GAAGACTGCACGTTGCATATTTGCCATCATCTATGGACCGTGCGAGAATTCAATACTAAT [0060]
B: [0039] GAAGACTGCACGTTGCATATTTGCCATCATCTATGGACCGTGCGAGAATTCAATACTAAT [0099]

A: [0060] CCTGTCCGC [0068]
B: [0099] CCTGTCCGC [0107]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">102.000</span>

=============================================================================
A: [0898] GCGTCTAACTTCTCTTACAGGCACAATCTCAGGTCGTTTATCCAGAATGACCACAAATCT [0958]
B: [0000] GCGTCTAACTTCTCTTACAGGCACAATCTCAGGTCGTTTATCCAGAATGACCACAAATCT [0060]

A: [0958] CGGTAAAATCTTTCTCGGCCTCTTACTCGGTGTGGACGGCGC [0999]
B: [0060] CGGTAAAATCTTTCTCGGCCTCTTACTCGGTGTGGACGGCGC [0101]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">210.000</span>

=============================================================================
A: [0396] GTAGGTCGGTGCAGTACTGAAGACAAGGCGATCAAGGCGTCCAAGAGCGCATGCCCCGAC [0456]
B: [0000] GTAGGTCGGTGCAGTACTGAAGACAAGGCGATCAAGGCGTCCAAGAGCGCATGCCCCGAC [0060]

A: [0456] CGAAGGTACATCCCGTGCTGTAGACGGACAGATCTTGCCCATCGGGTTTCCATTTATTTA [0516]
B: [0060] CGAAGGTACATCCCGTGCTGTAGACGGACAGATCTTGCCCATCGGGTTTCCATTTATTTA [0120]

A: [0516] ACAGCGGCTTATTATTAGCCATCGACTCTGAGTTCACCTTTACGACTCTCTCATTAATCC [0576]
B: [0120] ACAGCGGCTTATTATTAGCCATCGACTCTGAGTTCACCTTTACGACTCTCTCATTAATCC [0180]

A: [0576] CTAGGTAAACCTTGCATCCACGAACTAATT [0605]
B: [0180] CTAGGTAAACCTTGCATCCACGAACTAATT [0209]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">208.000</span>

=============================================================================
A: [0025] ATCATCTATGGACCGTGCGAGAATTCAATACTAATCCTGTCCGCAGTTAGTTTAAATCCG [0085]
B: [0000] ATCATCTATGGACCGTGCGAGAATTCAATACTAATCCTGTCCGCAGTTAGTTTAAATCCG [0060]

A: [0085] ACGGGCTCAGTTCGCTAGTAGAACCAACGCGCTCTCCAGGAATCTAACAATCAACTTCTT [0145]
B: [0060] ACGGGCTCAGTTCGCTAGTAGAACCAACGCGCTCTCCAGGAATCTAACAATCAACTTCTT [0120]

A: [0145] CATTGCCGGTAACCTTGTTCAATAACACTAACACCTTTCTAAGCCACCCGTAACAGTACT [0205]
B: [0120] CATTGCCGGTAACCTTGTTCAATAACACTAACACCTTTCTAAGCCACCCGTAACAGTACT [0180]

A: [0205] CCTTCCTGGGCTGTTCTACAACAAGGAG [0232]
B: [0180] CCTTCCTGGGCTGTTCTACAACAAGGAG [0207]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">100.000</span>

=============================================================================
A: [0844] TGGATTACCGCCAGAGGCCATCGCTGCGCGAGTTCTGGAAAAAGATTGAAACCAGCGTCT [0904]
B: [0000] TGGATTACCGCCAGAGGCCATCGCTGCGCGAGTTCTGGAAAAAGATTGAAACCAGCGTCT [0060]

A: [0904] AACTTCTCTTACAGGCACAATCTCAGGTCGTTTATCCAGA [0943]
B: [0060] AACTTCTCTTACAGGCACAATCTCAGGTCGTTTATCCAGA [0099]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">109.000</span>

=============================================================================
A: [0373] GTGAGTCAACGCGGGCCTAACCAGTAGGTCGGTGCAGTACTGAAGACAAGGCGATCAAGG [0433]
B: [0000] GTGAGTCAACGCGGGCCTAACCAGTAGGTCGGTGCAGTACTGAAGACAAGGCGATCAAGG [0060]

A: [0433] CGTCCAAGAGCGCATGCCCCGACCGAAGGTACATCCCGTGCTGTAGACG [0481]
B: [0060] CGTCCAAGAGCGCATGCCCCGACCGAAGGTACATCCCGTGCTGTAGACG [0108]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">157.000</span>

=============================================================================
A: [0713] CTCTCCTTCGAAACTCTACACCGGGGAAACTCGTCTCCATCCCCTTTGCATAGGTGTCTT [0773]
B: [0000] CTCTCCTTCGAAACTCTACACCGGGGAAACTCGTCTCCATCCCCTTTGCATAGGTGTCTT [0060]

A: [0773] CATTAAAAGTGTCATAGACTCAGACGTTCGCCTTCCTGAACCAACAGGATCAGCGGCTCC [0833]
B: [0060] CATTAAAAGTGTCATAGACTCAGACGTTCGCCTTCCTGAACCAACAGGATCAGCGGCTCC [0120]

A: [0833] CGGCCACCACTTGGATTACCGCCAGAGGCCATCGCTG [0869]
B: [0120] CGGCCACCACTTGGATTACCGCCAGAGGCCATCGCTG [0156]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">151.000</span>

=============================================================================
A: [0274] TTATTATTAGCCATCGACTCTGAGTTCACCTTTACGACTCTCTCATTAATCCCTAGGTAA [0334]
B: [0000] TTATTATTAGCCATCGACTCTGAGTTCACCTTTACGACTCTCTCATTAATCCCTAGGTAA [0060]

A: [0334] ACCTTGCATCCACGAACTAATTGCTATCTTATTGCACGCGTGAGTCAACGCGGGCCTAAC [0394]
B: [0060] ACCTTGCATCCACGAACTAATTGCTATCTTATTGCACGCGTGAGTCAACGCGGGCCTAAC [0120]

A: [0394] CAGTAGGTCGGTGCAGTACTGAAGACAAGGC [0424]
B: [0120] CAGTAGGTCGGTGCAGTACTGAAGACAAGGC [0150]
=============================================================================

Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">110.000</span>

=============================================================================
A: [0524] TTATTATTAGCCATCGACTCTGAGTTCACCTTTACGACTCTCTCATTAATCCCTAGGTAA [0584]
B: [0000] TTATTATTAGCCATCGACTCTGAGTTCACCTTTACGACTCTCTCATTAATCCCTAGGTAA [0060]

A: [0584] ACCTTGCATCCACGAACTAATTGCTATCTTATTGCACGCGTACTTATCAA [0633]
B: [0060] ACCTTGCATCCACGAACTAATTGCTATCTTATTGCACGCGTACTTATCAA [0109]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">110.000</span>

=============================================================================
A: [0246] ACCCGGTTTCCATTTATTTAACAGCGGCTTATTATTAGCCATCGACTCTGAGTTCACCTT [0306]
B: [0000] ACCCGGTTTCCATTTATTTAACAGCGGCTTATTATTAGCCATCGACTCTGAGTTCACCTT [0060]

A: [0306] TACGACTCTCTCATTAATCCCTAGGTAAACCTTGCATCCACGAACTAATT [0355]
B: [0060] TACGACTCTCTCATTAATCCCTAGGTAAACCTTGCATCCACGAACTAATT [0109]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">119.000</span>

=============================================================================
A: [0185] AAGCCACCCGTAACAGTACTCCTTCCTGGGCTGTTCTACAACAAGGAGAGGTTTACGTTT [0245]
B: [0000] AAGCCACCCGTAACAGTACTCCTTCCTGGGCTGTTCTACAACAAGGAGAGGTTTACGTTT [0060]

A: [0245] GACCCGGTTTCCATTTATTTAACAGCGGCTTATTATTAGCCATCGACTCTGAGTTCACC [0303]
B: [0060] GACCCGGTTTCCATTTATTTAACAGCGGCTTATTATTAGCCATCGACTCTGAGTTCACC [0118]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">105.000</span>

=============================================================================
A: [0340] CATCCACGAACTAATTGCTATCTTATTGCACGCGTGAGTCAACGCGGGCCTAACCAGTAG [0400]
B: [0000] CATCCACGAACTAATTGCTATCTTATTGCACGCGTGAGTCAACGCGGGCCTAACCAGTAG [0060]

A: [0400] GTCGGTGCAGTACTGAAGACAAGGCGATCAAGGCGTCCAAGAGCG [0444]
B: [0060] GTCGGTGCAGTACTGAAGACAAGGCGATCAAGGCGTCCAAGAGCG [0104]
=============================================================================

************************************************************
Model: <span class="ansi-bold">SmithWaterman</span>
Alignment score: <span class="ansi-red-fg">100.000</span>

=============================================================================
A: [0567] CATTAATCCCTAGGTAAACCTTGCATCCACGAACTAATTGCTATCTTATTGCACGCGTAC [0627]
B: [0000] CATTAATCCCTAGGTAAACCTTGCATCCACGAACTAATTGCTATCTTATTGCACGCGTAC [0060]

A: [0627] TTATCAAATTAAGTAGTCATCCGTCACACGAGACGGAAGC [0666]
B: [0060] TTATCAAATTAAGTAGTCATCCGTCACACGAGACGGAAGC [0099]
=============================================================================

************************************************************
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

            <div>
</div>

            
            
            <hr/>
            <aside class="article_meta">
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://iwasakishuto.github.io/University/3A/生命情報表現論-5.html" title="Previous: 生命情報表現論 第5回">生命情報表現論 第5回</a></li>
                <li class="next-article"><a href="https://iwasakishuto.github.io/University/3A/分子生命科学Ⅲ-11.html" title="Next: 分子生命科学Ⅲ 第11回">分子生命科学Ⅲ 第11回</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section class="article_meta">
            <div class="span2" style="float:right;font-size:0.9em; text-align: center;">
                <a class="btn-square-pop" onclick="switchVisibility('_article_meta_')">hidden</a>
            </div>

            <div class="span2" id="_article_meta_" style="float:right;font-size:0.9em;">
                <h5>Table of Contents</h5>
                <div id="toc"></div>

                <h5>Published</h5>
                <time itemprop="dateCreated" datetime="2019-12-17T13:00:00+09:00">12 17, 2019</time>

<h5>Last Updated</h5>
<time datetime="2019-12-17T13:00:00+09:00">12 17, 2019</time>

                <h5>Category</h5>
                <a class="category-link" href="https://iwasakishuto.github.io/University/3A/categories.html#qing-bao-ji-chu-shi-yan-sen-xia-ref">情報基礎実験(森下)</a>
                <h5>Tags</h5>
                <ul class="list-of-tags tags-in-article">
                    <li><a href="https://iwasakishuto.github.io/University/3A/tags#3a-ref">3A
                        <span>127</span>
</a></li>
                    <li><a href="https://iwasakishuto.github.io/University/3A/tags#qing-bao-ji-chu-shi-yan-sen-xia-ref">情報基礎実験(森下)
                        <span>8</span>
</a></li>
                </ul>
<h5>Contact</h5>
    <a href="https://twitter.com/cabernet_rock" title="My twitter Profile" class="sidebar-social-links" target="_blank">
    <i class="fab fa-twitter sidebar-social-links"></i></a>
    <a href="https://github.com/iwasakishuto" title="My github Profile" class="sidebar-social-links" target="_blank">
    <i class="fab fa-github sidebar-social-links"></i></a>
    <a href="https://www.facebook.com/iwasakishuto" title="My facebook Profile" class="sidebar-social-links" target="_blank">
    <i class="fab fa-facebook sidebar-social-links"></i></a>
            </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer class="article_meta">
  <div id="footer">
    <ul class="footer-content">
        <li class="elegant-subtitle"><span class="site-name">3A</span> - Shuto's Notes</li>
        <li class="elegant-license">MIT</li>
      <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="https://github.com/Pelican-Elegant/elegant/" title="Theme Elegant Home Page">Elegant</a></li>
    </ul>
  </div>
</footer>            <script src="https://code.jquery.com/jquery.min.js"></script>
        <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>
        <script src="https://iwasakishuto.github.io/js/custom.js"></script>
        <script src="https://iwasakishuto.github.io/js/smooth-scroll.polyfills.min.js"></script>
        <script src="https://iwasakishuto.github.io/js/toc.min.js"></script>
        <script>
            jQuery('#toc').toc({
                'container': 'div.article-content',
                'selectors': 'h2, h3, h4',
            });
        </script>

    
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/css/jupyter.css">
    </body>
    <!-- Theme: Elegant built for Pelican
    License : MIT -->
</html>